x = [0.00,0.50,1.00,1.50,2.00,2.50,3.00,4.00,4.50,5.00,6.00,6.50,7.00,7.50,8.00,8.50,9.00,9.50,9.50,10.00,10.50,11.00,11.50,11.50,12.00,12.50,13.00,13.50,14.00,14.50,14.50,15.00,15.50,15.50,16.00,16.50,17.00,17.50,18.00,18.50,19.00,19.50,20.00,21.00,21.50,22.00,22.50,23.00,23.50,24.00,24.50,25.00,25.50,26.00,26.50,27.00,28.00,29.00,29.50,30.00,31.00,31.50,32.00,33.00,33.50,34.00,35.00,36.00,36.50,37.00,37.50,37.50,37.50,37.00,36.50,36.00,35.00,34.00,33.50,33.00,32.00,31.50,31.00,30.50,30.00,29.50,29.50,29.00,28.50,28.50,28.50,29.00,29.50,30.00,31.00,32.00,32.50,33.00,33.50,34.00,34.50,35.00,36.00,37.00,37.50,38.00,38.50,39.00,40.00,40.50,41.00,42.00,43.00,43.50,44.00,45.00,45.50,46.00,47.00,47.50,48.00,49.00,49.50,50.00,51.00,51.50,52.00,53.00,54.00,54.50,55.00,55.50,55.50,55.00,54.50,54.00,53.50,53.00,52.50,52.00,51.50,51.00,50.50,50.50,50.00,49.50,49.50,49.00,48.50,48.00,47.50,47.00,46.50,46.00,45.00,44.00,43.00,42.50,42.00,41.00,40.00,39.50,39.00,38.00,37.00,36.50,36.00,35.00,34.00,33.00,32.00,31.00,30.50,30.00,29.00,28.50,28.00,27.50,27.00,26.50,26.00,25.50,25.00,24.50,24.00,23.00,22.00,21.50,21.00,20.00,19.50,19.00,18.50,18.00,17.00,16.50,16.00,15.50,15.50,15.00,14.50,14.50,14.50,14.50,14.50,15.00,15.50,15.50,16.00,17.00,17.50,18.00,19.00,20.00,20.50,21.00,22.00,22.50,23.00,23.50,24.00,25.00,25.50,26.00,26.50,26.50,27.00,27.50,27.50,27.50,28.00,28.50,29.00,30.00,31.00,31.50,32.00,32.50,33.00,34.00,34.50,35.00,35.50,36.00,36.50,37.00,37.50,37.50,38.00,38.50,39.00,39.50,40.00,40.50,41.00,42.00,43.00,44.00,45.00,45.50,46.00,46.50,47.00,47.50,47.50,47.00,46.50,46.00,45.50,45.00,44.50,44.00,43.50,43.00,42.50,42.50,42.00,41.50,41.50,41.50,41.00,40.50,40.00,39.50,39.00,38.00,37.00,36.50,36.00,35.00,34.50,34.00,33.50,33.00,32.50,32.50,32.00,31.50,31.50,31.50,32.00,32.50,33.00,33.50,34.00,35.00,36.00,37.00,38.00,39.00,39.50,40.00,40.50,40.50,41.00,42.00,42.50,43.00,43.50,44.00,45.00,45.50,46.00,46.50,47.00,48.00,49.00,50.00,50.50,51.00,52.00,52.50,53.00,54.00,54.50,55.00,56.00,57.00,57.50,58.00,59.00,59.50,60.00,61.00,62.00,63.00,64.00,64.50,65.00,66.00,66.50,66.50,66.50,66.50,66.50,66.50,67.00,67.50,68.00,68.50,69.00,70.00,70.50,71.00,72.00,72.50,73.00,73.50,73.50,74.00,74.50,74.00,73.50,73.50,73.00,72.00,71.50,71.00,70.00,69.00,68.50,68.00,67.00,66.50,66.00,65.50,65.50,65.00,64.50,64.00,63.50,63.00,62.00,61.50,61.00,60.00,59.50,59.00,58.50,58.00,57.50,57.00,56.00,55.50,55.00,54.00,53.00,52.00,51.50,51.00,50.50,50.00,49.50,49.50,50.00,50.50,51.00,51.50,52.00,52.50,53.00,54.00,54.50,54.50,55.00,55.50,55.50,55.50,55.50,55.50,55.50,56.00,56.50,57.00,57.50,58.00,58.50,59.00,59.50,60.00,60.50,61.00,61.50,62.00,63.00,63.50,64.00,65.00,65.50,66.00,67.00,67.50,68.00,69.00,69.50,70.00,71.00,71.50,72.00,73.00,73.50,74.00,75.00,75.50,76.00,76.50,76.50,77.00,77.50,77.50,77.00,76.50,76.50,76.00,75.50,75.50,75.50,75.50,75.50,75.50,75.50,75.50,75.00,74.50,74.50,74.50,74.50,74.50,75.00,75.50,76.00,76.50,77.00,78.00,78.50,79.00,80.00,80.50,81.00,82.00,82.50,83.00,83.50,84.00,84.50,85.00,86.00,86.50,87.00,87.50,88.00,89.00,89.50,90.00,91.00,91.50,92.00,92.50,93.00,94.00,94.50,95.00,95.50,96.00,97.00,97.50,98.00,99.00,99.50,100.00,101.00,101.50,102.00,102.50,103.00,104.00,104.50,105.00,105.50,106.00,107.00,107.50,108.00,108.50,109.00,110.00,110.50,111.00,111.50,112.00,113.00,113.50,114.00,115.00,115.50,116.00,117.00,117.50,118.00,119.00,119.50,120.00,120.50,121.00,122.00,122.50,123.00,124.00,124.50,125.00,125.50,126.00,127.00,127.50,128.00,129.00,129.50,130.00,131.00,131.50,132.00,133.00,133.50,134.00,134.50,135.00,136.00,136.50,137.00,137.50,138.00,139.00,139.50,140.00,141.00,141.50,142.00,142.50,143.00,144.00,144.50,145.00,146.00,146.50,147.00,147.50,148.00,149.00,149.50,150.00,151.00,151.50,152.00,152.50,153.00,153.50,154.00,154.50,155.00,155.50,156.00,157.00,158.00,158.50,159.00,159.50,160.00,160.50,160.00,159.50,159.50,159.00,158.50,159.00,159.50,160.00,161.00,161.50,162.00,163.00,163.50,164.00,165.00,165.50,166.00,167.00,168.00,169.00,169.50,170.00,170.50,171.00,172.00,173.00,173.50,174.00,175.00,175.50,176.00,177.00,178.00,178.50,179.00,180.00,180.50,181.00,182.00,182.50,183.00,183.50,184.00,185.00,185.50,186.00,186.50,187.00,188.00,188.50,189.00,190.00,190.50,191.00,192.00,192.50,192.50,192.50,192.50,192.00,191.50,192.00,192.50,193.00,193.50,194.00,195.00,196.00,196.50,197.00,198.00,198.50,199.00,199.50,200.00,200.50,200.50,201.00,201.50,202.00,202.50,203.00,204.00,205.00,205.50,206.00,207.00,207.50,208.00,208.50,209.00,209.50,210.00,210.50,211.00,212.00,212.50,213.00,214.00,214.50,215.00,216.00,216.50,217.00,218.00,218.50,219.00,220.00,221.00,221.50,222.00,223.00,223.50,223.50,223.50,223.00,222.50,222.00,221.50,221.00,220.00,219.00,218.50,218.00,217.50,217.50,217.50,217.50,218.00,218.50,219.00,219.50,220.00,220.50,221.00,221.50,222.00,223.00,223.50,224.00,225.00,226.00,227.00,228.00,229.00,230.00,230.50,231.00,231.50,231.50,231.00,230.50,230.50,230.50,231.00,231.50,232.00,233.00,233.50,234.00,234.50,235.00,235.50,236.00,236.50,237.00,237.50,238.00,239.00,240.00,240.50,241.00,242.00,242.50,243.00,244.00,244.50,245.00,245.50,246.00,247.00,248.00,249.00,250.00,250.50,251.00,251.50,251.50,251.50,251.50,251.00,250.50,250.00,249.50,249.00,248.00,247.50,247.00,246.50,246.00,245.00,244.50,244.00,243.50,243.00,242.50,242.00,241.50,241.00,240.50,240.00,239.00,238.50,238.00,237.50,237.50,237.00,236.50,236.00,235.50,235.00,234.50,234.00,233.00,232.00,231.50,231.00,230.00,229.50,229.00,228.00,227.50,227.00,226.00,225.50,225.00,224.50,224.00,223.50,223.00,222.00,221.50,221.00,220.50,220.00,219.00,218.00,217.50,217.00,216.00,215.50,215.00,214.00,213.50,213.00,212.00,211.00,210.50,210.00,209.00,208.50,208.00,207.00,206.50,206.00,205.00,204.50,204.00,203.50,203.00,202.00,201.50,201.00,200.50,200.00,199.50,199.00,198.00,197.50,197.00,196.00,195.50,195.00,194.50,194.00,193.00,192.50,192.00,191.00,190.50,190.00,189.00,188.50,188.00,187.00,186.50,186.00,185.50,185.00,184.00,183.50,183.00,182.00,181.00,180.50,180.00,179.00,178.50,178.00,177.00,176.50,176.00,175.00,174.00,173.00,172.50,172.00,171.00,170.50,170.50,170.50,171.00,171.50,172.00,173.00,174.00,174.50,175.00,175.50,176.00,176.50,176.50,176.00,175.50,175.00,174.50,174.00,173.00,172.00,171.50,171.00,170.00,169.50,169.50,169.00,168.50,169.00,169.50,169.50,170.00,170.50,171.00,171.50,172.00,172.50,173.00,173.50,173.50,173.50,173.00,172.50,172.00,171.50,171.00,170.00,169.00,168.00,167.50,167.00,166.50,166.00,165.50,165.00,164.50,164.50,164.50,165.00,165.50,165.00,164.50,164.00,163.00,162.00,161.50,161.00,160.00,159.50,159.00,158.50,158.00,157.50,157.50,157.00,156.50,156.50,157.00,157.50,157.50,157.50,157.50,158.00,158.50,159.00,159.50,160.00,161.00,161.50,162.00,162.50,162.50,162.50,162.00,161.50,161.00,160.50,160.00,159.00,158.50,158.00,157.00,156.50,156.00,155.00,154.00,153.00,152.50,152.00,151.00,150.50,150.00,149.00,148.50,148.00,147.50,147.00,146.50,146.00,145.00,144.50,144.00,143.50,143.00,142.50,142.00,141.00,140.00,139.50,139.00,138.00,137.00,136.50,136.00,135.00,134.50,134.00,133.50,133.00,132.00,131.50,131.00,130.00,129.50,129.00,128.00,127.50,127.00,126.00,125.00,124.00,123.00,122.00,121.50,121.00,120.00,119.00,118.00,117.00,116.50,116.00,115.00,114.00,113.50,113.00,112.00,111.50,111.00,110.00,109.50,109.00,108.50,108.00,107.00,106.50,106.00,105.00,104.50,104.00,103.50,103.00,102.50,102.00,101.50,101.00,100.00,99.00,98.00,97.50,97.00,96.00,95.50,95.00,94.00,93.50,93.00,92.00,91.50,91.00,90.50,90.00,89.50,89.50,89.00,88.50,88.50,88.50,88.50,88.50,88.50,88.50,89.00,89.50,89.50,90.00,91.00,91.50,92.00,92.50,93.00,94.00,94.50,95.00,95.50,96.00,97.00,97.50,98.00,98.50,99.00,100.00,101.00,102.00,103.00,103.50,104.00,104.50,105.00,105.50,106.00,106.50,107.00,108.00,109.00,110.00,111.00,111.50,112.00,113.00,113.50,114.00,114.50,115.00,116.00,116.50,117.00,118.00,118.50,119.00,120.00,120.50,121.00,122.00,123.00,123.50,124.00,125.00,125.50,126.00,127.00,128.00,128.50,129.00,130.00,130.50,131.00,131.50,132.00,132.50,133.00,134.00,134.50,135.00,136.00,136.50,137.00,138.00,139.00,139.50,140.00,141.00,141.50,142.00,142.50,143.00,144.00,144.50,145.00,145.50,146.00,147.00,147.50,148.00,148.50,149.00,149.50,150.00,150.50,151.00,152.00,152.50,153.00,154.00,155.00,155.50,156.00,157.00,157.50,158.00,159.00,159.50,160.00,160.50,161.00,162.00,162.50,163.00,164.00,164.50,165.00,165.50,166.00,166.50,167.00,167.50,168.00,169.00,169.50,170.00,171.00,171.50,172.00,172.50,173.00,174.00,174.50,175.00,176.00,176.50,177.00,177.50,178.00,179.00,179.50,180.00,180.50,181.00,181.50,182.00,182.50,183.00,184.00,184.50,185.00,185.50,186.00,186.50,187.00,188.00,188.50,189.00,189.50,190.00,190.50,191.00,191.50,192.00,192.50,193.00,193.50,194.00,194.50,194.50,194.50,194.00,193.50,193.00,192.50,192.50,192.50,193.00,193.50,194.00,194.50,195.00,196.00,196.50,197.00,198.00,199.00,199.50,200.00,200.50,200.00,199.50,199.00,198.50,198.50,198.00,197.50,197.50,198.00,198.50,199.00,199.50,200.00,201.00,201.50,202.00,203.00,203.50,204.00,204.50,205.00,205.50,206.00,206.50,207.00,207.50,208.00,209.00,210.00,210.50,211.00,211.50,211.50,211.50,211.50,211.50,211.50,211.00,210.50,210.00,209.50,209.00,208.50,208.00,207.00,206.50,206.00,205.00,204.50,204.00,203.50,203.00,202.00,201.50,201.00,200.50,200.00,199.50,199.00,198.50,198.00,197.00,196.00,195.50,195.00,194.00,193.50,193.00,192.50,192.00,191.00,190.00,189.50,189.00,188.00,187.50,187.00,186.50,186.00,185.50,185.00,184.00,183.50,183.00,182.00,181.50,181.00,180.50,180.00,179.00,178.50,178.00,177.50,177.00,176.50,176.00,175.00,174.50,174.00,173.50,173.00,172.50,172.00,171.00,170.50,170.00,169.50,169.00,168.50,168.00,167.50,167.00,166.50,166.00,165.00,164.00,163.00,162.50,162.00,161.00,160.50,160.00,159.00,158.50,158.00,157.00,156.50,156.00,155.00,154.50,154.00,153.50,153.00,152.00,151.00,150.50,150.00,149.50,149.50,149.00,148.50,148.00,147.50,147.00,146.50,146.00,145.50,145.00,144.00,143.00,142.50,142.00,141.00,140.50,140.00,139.00,138.50,138.00,137.50,137.00,136.00,135.50,135.00,134.00,133.50,133.00,132.50,132.00,131.00,130.50,130.00,129.00,128.50,128.00,127.00,126.50,126.00,125.00,124.50,124.00,123.00,122.50,122.00,121.50,121.00,120.50,120.00,119.00,118.50,118.00,117.00,116.50,116.00,115.00,114.50,114.00,113.00,112.50,112.00,111.00,110.50,110.00,109.00,108.50,108.00,107.00,106.50,106.00,105.00,104.00,103.50,103.00,102.00,101.00,100.50,100.00,99.00,98.00,97.50,97.00,96.00,95.00,94.00,93.00,92.00,91.00,90.00,89.00,88.50,88.00,87.00,86.50,86.00,85.00,84.50,84.00,83.50,83.00,82.50,82.00,81.50,81.00,80.50,80.00,79.50,79.00,78.50,78.00,77.50,77.00,76.50,76.50,77.00,77.50,78.00,79.00,79.50,80.00,81.00,82.00,82.50,83.00,84.00,84.50,85.00,86.00,86.50,87.00,88.00,88.50,89.00,90.00,91.00,92.00,92.50,93.00,93.50,94.00,94.50,94.50,94.00,93.50,93.00,92.50,92.00,91.50,91.00,90.50,90.00,89.00,88.00,87.00,86.00,85.50,85.00,84.00,83.50,83.00,82.00,81.00,80.50,80.00,79.00,78.50,78.00,77.00,76.50,76.00,75.00,74.50,74.00,73.50,73.00,72.00,71.50,71.00,70.50,70.50,70.50,70.50,70.50,70.50,70.50,70.00,69.50,69.50,69.50,69.00,68.50,68.00,67.50,67.00,66.50,66.00,65.00,64.00,63.00,62.50,62.00,61.00,60.50,60.00,59.50,59.00,58.00,57.50,57.00,56.00,55.50,55.00,54.00,53.00,52.50,52.00,51.00,50.00,49.50,49.00,48.00,47.50,47.00,46.00,45.50,45.00,44.00,43.50,43.00,42.50,42.00,41.50,41.50,41.00,40.50,40.50,40.50,40.00,39.50,39.00,38.50,38.00,37.00,36.00,35.00,34.00,33.00,32.00,31.50,31.00,30.00,29.00,28.00,27.00,26.50,26.00,25.00,24.00,23.00,22.00,21.00,20.00,19.00,18.00,17.00,16.00,15.50,15.00,14.50,14.00,13.50,13.50,14.00,14.50,15.00,15.50,16.00,16.50,17.00,17.50,18.00,18.50,19.00,20.00,21.00,21.50,22.00,23.00,23.50,24.00,24.50,25.00,25.50,26.00,26.50,27.00,27.50,28.00,28.50,29.00,30.00,30.50,31.00,32.00,32.50,33.00,33.50,34.00,34.50,34.50,34.50,34.00,33.50,33.00,32.00,31.50,31.00,30.00,29.50,29.00,28.50,28.00,27.50,27.00,26.00,25.50,25.00,24.50,24.00,23.50,23.50,23.00,22.00,21.50,21.00,20.50,20.00,19.50,19.00,18.50,18.00,17.00,16.50,16.00,15.00,14.00,13.00,12.00,11.00,10.00,9.00,8.00,7.00,6.00,5.00,4.50,4.00,3.00,2.50,2.00,1.00,0.50,0.00]
y = [393.00,392.50,392.00,391.50,391.50,391.00,390.50,390.50,390.00,389.50,389.00,388.50,388.00,387.50,387.00,386.00,385.50,385.00,384.50,384.00,383.00,382.50,382.00,381.50,381.00,380.50,380.00,379.00,378.50,378.00,377.00,376.50,376.00,375.50,375.00,374.50,374.00,373.50,373.00,372.50,372.50,372.00,371.50,371.00,370.50,370.00,369.50,369.00,368.50,368.00,367.50,367.00,366.50,366.50,366.50,366.00,365.50,365.50,365.00,364.50,364.50,364.00,363.50,363.50,363.50,364.00,364.50,365.00,366.00,367.00,367.50,368.00,368.50,368.50,368.50,369.00,369.50,369.50,370.00,370.50,371.00,371.50,372.00,373.00,373.50,374.00,375.00,376.00,376.50,377.00,377.50,377.50,377.50,377.00,376.50,376.00,375.50,375.00,374.50,374.50,374.50,375.00,375.50,376.00,376.50,376.50,377.00,377.50,377.50,377.50,377.00,376.50,376.50,376.00,375.50,375.50,375.00,374.50,374.50,374.00,373.50,373.50,373.00,372.50,372.50,372.50,373.00,373.50,374.00,375.00,375.50,376.00,376.50,377.00,377.50,378.00,378.50,379.00,379.50,380.00,381.00,381.50,382.00,383.00,383.50,384.00,384.50,385.00,385.50,386.00,386.50,386.50,386.50,386.50,386.00,385.50,385.50,385.50,386.00,386.50,386.50,386.50,387.00,387.50,387.50,387.50,387.50,387.50,387.50,388.00,388.50,388.50,389.00,389.50,390.00,390.50,391.00,391.50,392.00,392.50,393.00,393.50,393.50,393.50,394.00,394.50,394.50,395.00,395.50,396.00,396.50,396.50,397.00,397.50,398.00,399.00,399.50,400.00,401.00,402.00,403.00,404.00,404.50,405.00,406.00,406.50,406.50,407.00,407.50,407.50,407.50,408.00,408.50,408.50,409.00,409.50,409.00,408.50,408.50,408.00,407.50,407.00,406.00,405.50,405.00,404.00,403.00,402.50,402.00,401.50,401.50,401.50,402.00,402.50,402.00,401.50,401.50,401.00,400.50,400.00,399.50,399.00,398.50,398.00,397.00,396.50,396.00,395.50,395.00,394.50,394.00,393.50,393.50,393.50,393.50,393.50,394.00,394.50,395.00,395.50,396.00,397.00,397.50,398.00,398.50,399.00,399.50,400.00,400.50,401.00,401.50,402.00,403.00,403.50,404.00,405.00,406.00,406.50,407.00,407.50,408.00,408.50,408.50,408.50,409.00,409.50,409.50,410.00,410.50,411.00,411.50,412.00,413.00,413.50,414.00,415.00,416.00,416.50,417.00,417.50,418.00,418.50,418.50,418.50,418.50,418.50,418.50,419.00,419.50,420.00,421.00,421.50,421.50,422.00,422.50,422.00,421.50,421.50,421.00,420.50,420.00,419.50,419.50,419.50,419.50,419.00,418.50,418.50,418.00,417.50,417.50,417.00,416.50,416.50,416.50,416.00,415.50,415.50,415.00,414.50,414.50,414.50,414.50,414.50,414.00,413.50,413.50,413.00,412.00,411.00,410.00,409.00,408.00,407.50,407.00,406.50,406.00,405.50,405.50,405.00,404.50,404.50,404.00,403.50,403.00,402.00,401.50,401.00,400.50,400.00,399.00,398.50,398.50,398.00,397.50,397.50,397.50,398.00,398.50,398.50,399.00,399.50,400.00,401.00,401.50,402.00,402.50,403.00,403.50,403.50,404.00,404.50,404.50,405.00,405.50,406.00,406.50,407.00,407.50,407.50,408.00,408.50,408.50,408.50,408.50,408.00,407.50,407.00,406.50,406.00,405.00,404.50,404.00,403.50,403.00,402.50,402.00,401.50,401.50,401.00,400.00,399.50,399.00,398.00,397.00,396.00,395.00,394.00,393.50,393.00,392.50,392.00,391.50,391.00,390.50,390.00,389.50,389.00,388.50,388.00,387.50,387.50,387.00,386.50,386.50,386.00,385.50,385.50,385.00,384.50,384.50,384.00,383.50,383.50,383.00,382.50,382.50,382.00,381.50,381.50,381.00,380.50,380.00,379.00,378.50,378.00,377.00,376.50,376.00,375.00,374.50,374.00,373.00,372.00,371.00,370.00,369.00,368.00,367.00,366.50,366.00,365.00,364.00,363.00,362.00,361.50,361.00,360.50,360.00,359.50,359.50,359.00,358.50,358.50,358.00,357.50,357.50,357.00,356.50,356.00,355.50,355.00,354.50,354.50,354.00,353.50,353.00,352.50,352.50,352.00,351.50,351.50,351.00,350.50,350.00,349.50,349.50,349.00,348.50,348.00,347.50,347.50,347.00,346.50,346.50,346.00,345.50,345.50,345.00,344.50,344.00,343.50,343.50,343.00,342.50,342.00,341.50,341.50,341.00,340.50,340.00,339.50,339.50,339.00,338.50,338.00,337.50,337.50,337.00,336.50,336.50,336.00,335.50,335.50,335.00,334.50,334.50,334.00,333.50,333.00,332.50,332.50,332.00,331.50,331.50,331.00,330.50,330.00,329.50,329.50,329.00,328.50,328.50,328.00,327.50,327.50,327.00,326.50,326.50,326.00,325.50,325.00,324.50,324.50,324.00,323.50,323.00,322.50,322.50,322.00,321.50,321.50,321.00,320.50,320.00,319.50,319.50,319.00,318.50,318.50,318.00,317.50,317.00,316.50,316.50,316.00,315.50,315.50,315.00,314.50,314.00,313.50,313.00,312.50,312.00,311.50,311.00,310.50,310.50,310.50,310.00,309.50,309.00,308.50,308.00,307.50,307.00,306.00,305.50,305.00,304.50,304.00,303.50,303.50,303.00,302.50,302.50,302.00,301.50,301.50,301.00,300.50,300.50,300.50,300.50,301.00,301.50,302.00,302.50,302.50,302.50,302.00,301.50,301.50,301.00,300.50,300.50,300.50,300.00,299.50,299.50,299.00,298.50,298.50,298.00,297.50,297.00,296.50,296.50,296.00,295.50,295.00,294.50,294.50,294.00,293.50,293.50,293.00,292.50,292.50,292.00,291.00,290.00,289.00,288.50,288.00,287.50,287.00,286.50,286.00,285.50,285.50,285.50,286.00,286.50,286.50,286.00,285.50,285.00,284.50,284.00,283.00,282.50,282.00,281.50,281.00,280.50,280.50,280.50,280.00,279.50,279.50,279.00,278.50,278.00,277.50,277.00,276.50,276.00,275.50,275.50,275.00,274.50,274.50,274.00,273.50,273.50,273.00,272.50,272.50,272.00,271.50,271.50,271.50,271.00,270.50,270.50,270.00,269.00,268.00,267.50,267.00,266.50,267.00,267.50,267.50,267.50,267.00,266.50,266.00,265.00,264.00,263.00,262.50,262.00,261.50,261.00,260.50,260.00,259.50,259.00,258.50,258.50,258.00,257.50,257.50,257.50,257.50,257.50,257.50,257.50,258.00,258.50,259.00,260.00,260.50,261.00,262.00,263.00,263.50,264.00,264.50,264.50,265.00,265.50,265.00,264.50,264.00,263.50,263.00,262.50,262.00,261.50,261.50,261.50,261.00,260.50,260.50,260.00,259.50,259.50,259.00,258.50,258.00,257.50,257.50,257.50,257.50,257.50,258.00,258.50,259.00,260.00,261.00,262.00,262.50,263.00,263.50,264.00,264.50,264.50,265.00,265.50,266.00,266.50,266.50,267.00,267.50,268.00,268.50,269.00,269.50,270.00,270.50,271.00,271.50,271.50,272.00,272.50,273.00,274.00,274.50,275.00,275.50,276.00,276.50,277.00,277.50,277.50,277.50,277.00,276.50,276.50,277.00,277.50,277.50,278.00,278.50,278.50,279.00,279.50,280.00,280.50,281.00,281.50,281.50,282.00,282.50,283.00,283.50,283.50,283.50,284.00,284.50,284.50,285.00,285.50,285.50,286.00,286.50,286.50,286.50,287.00,287.50,287.50,288.00,288.50,288.50,289.00,289.50,289.50,290.00,290.50,291.00,291.50,291.50,292.00,292.50,293.00,293.50,294.00,294.50,294.50,295.00,295.50,295.50,296.00,296.50,297.00,297.50,297.50,298.00,298.50,298.50,299.00,299.50,299.50,300.00,300.50,300.50,301.00,301.50,302.00,302.50,302.50,303.00,303.50,303.50,303.50,304.00,304.50,304.50,305.00,305.50,305.50,306.00,306.50,306.50,306.50,306.50,307.00,307.50,307.50,308.00,309.00,310.00,310.50,311.00,311.50,311.50,311.50,312.00,312.50,313.00,313.50,314.00,315.00,315.50,316.00,316.50,317.00,317.50,317.50,317.50,318.00,318.50,318.50,319.00,320.00,320.50,321.00,321.50,322.00,323.00,323.50,324.00,324.50,325.00,325.50,326.00,326.50,327.00,328.00,329.00,329.50,330.00,330.50,331.00,331.50,331.50,331.50,331.50,331.00,330.50,330.00,329.50,329.00,328.50,328.00,327.00,326.00,325.50,325.00,324.50,324.00,323.50,323.50,323.50,324.00,324.50,324.50,325.00,325.50,326.00,326.50,327.00,328.00,328.50,329.00,330.00,330.50,331.00,332.00,333.00,334.00,334.50,335.00,335.50,336.00,336.50,336.50,337.00,337.50,338.00,339.00,340.00,340.50,341.00,341.50,342.00,342.50,342.50,343.00,343.50,343.50,344.00,344.50,344.50,344.50,344.50,345.00,345.50,345.50,346.00,346.50,346.50,347.00,347.50,348.00,348.50,349.00,349.50,349.50,350.00,350.50,351.00,351.50,352.00,352.50,352.50,352.50,353.00,353.50,353.50,353.50,354.00,354.50,354.50,355.00,355.50,356.00,356.50,356.50,357.00,357.50,357.50,358.00,358.50,358.50,359.00,359.50,359.50,359.50,359.50,359.50,359.50,360.00,360.50,360.50,360.50,360.50,360.50,361.00,361.50,361.50,361.50,362.00,362.50,362.50,363.00,363.50,363.50,364.00,364.50,365.00,365.50,365.50,366.00,366.50,366.50,367.00,367.50,368.00,368.50,369.00,369.50,370.00,370.50,370.50,370.50,370.50,371.00,371.50,371.50,372.00,372.50,372.50,373.00,373.50,373.50,374.00,374.50,375.00,375.50,376.00,377.00,377.50,378.00,379.00,380.00,381.00,382.00,383.00,384.00,384.50,385.00,386.00,386.50,386.50,387.00,387.50,387.00,386.50,386.50,386.00,385.50,385.00,384.50,384.50,384.00,383.50,383.00,382.50,382.50,382.50,382.50,382.50,382.00,381.50,381.00,380.50,380.00,379.50,379.00,378.50,378.50,378.50,378.50,378.50,378.00,377.50,377.50,377.00,376.50,376.00,375.50,375.50,375.00,374.50,374.50,374.00,373.50,373.50,373.00,372.50,372.50,372.50,372.00,371.50,371.50,371.00,370.50,370.50,370.50,370.00,369.50,369.50,369.00,368.50,368.00,367.50,367.00,366.50,366.50,366.00,365.50,365.50,365.00,364.50,364.50,364.50,364.00,363.50,363.50,363.00,362.50,362.00,361.50,361.50,361.00,360.50,360.00,359.50,359.50,359.00,358.50,358.00,357.50,357.00,356.50,356.00,355.50,355.50,355.00,354.50,354.50,354.50,354.00,353.50,353.50,353.00,352.50,352.50,352.00,351.50,351.00,350.50,350.50,350.00,349.50,349.50,349.00,348.50,348.00,347.50,347.00,346.50,346.00,345.50,345.50,345.00,344.50,344.50,344.00,343.50,343.00,342.50,342.50,342.00,341.50,341.50,341.00,340.50,340.00,339.50,339.50,339.00,338.50,338.00,337.50,337.00,336.50,336.00,335.50,335.50,335.00,334.50,334.00,333.50,333.00,332.50,332.50,332.00,331.50,331.00,330.50,330.00,329.50,329.00,328.50,328.00,327.50,327.00,326.50,326.00,325.00,324.00,323.50,323.00,322.50,322.00,321.00,320.00,319.50,319.00,318.50,318.00,317.50,317.50,317.00,316.50,316.50,316.50,317.00,317.50,318.00,318.50,319.00,319.50,320.00,321.00,321.50,322.00,323.00,323.50,324.00,324.50,325.00,325.50,325.50,325.00,324.50,324.50,324.00,323.50,323.00,322.50,322.00,321.50,321.00,320.50,320.00,319.50,319.50,319.50,320.00,320.50,321.00,322.00,323.00,324.00,325.00,326.00,326.50,327.00,327.50,328.00,328.50,329.00,329.50,329.50,330.00,330.50,330.50,331.00,331.50,332.00,332.50,332.50,333.00,333.50,334.00,334.50,335.00,335.50,336.00,336.50,336.50,336.50,337.00,337.50,337.50,338.00,338.50,339.00,339.50,339.50,339.50,340.00,340.50,340.50,341.00,341.50,342.00,342.50,343.00,343.50,343.50,344.00,344.50,344.50,345.00,345.50,346.00,346.50,346.50,347.00,347.50,348.00,348.50,349.00,349.50,349.50,350.00,350.50,351.00,351.50,352.00,352.50,352.50,353.00,353.50,354.00,354.50,355.00,355.50,356.00,356.50,357.00,357.50,357.50,357.50,357.50,358.00,358.50,358.50,359.00,359.50,359.50,360.00,360.50,360.50,361.00,361.50,361.50,362.00,362.50,363.00,363.50,363.50,363.50,364.00,364.50,365.00,366.00,366.50,367.00,367.50,368.00,368.50,369.00,369.50,370.00,370.50,370.50,370.50,371.00,371.50,371.50,372.00,372.50,372.50,373.00,373.50,374.00,374.50,374.50,375.00,375.50,375.50,376.00,376.50,377.00,377.50,377.50,378.00,378.50,378.50,379.00,379.50,379.50,380.00,380.50,380.50,381.00,381.50,381.50,382.00,382.50,383.00,383.50,384.00,384.50,384.50,385.00,385.50,385.50,386.00,386.50,386.50,387.00,387.50,387.50,388.00,388.50,388.50,389.00,389.50,389.50,390.00,390.50,390.50,391.00,391.50,391.50,391.50,392.00,392.50,392.50,392.50,393.00,393.50,393.50,393.50,394.00,394.50,394.50,394.50,394.50,394.50,394.50,394.50,394.50,394.50,395.00,395.50,395.50,396.00,396.50,396.50,397.00,397.50,398.00,398.50,399.00,399.50,400.00,400.50,401.00,401.50,402.00,402.50,403.00,403.50,404.00,404.50,405.00,406.00,406.50,407.00,407.50,407.50,407.00,406.50,406.50,406.50,406.00,405.50,405.50,405.00,404.50,404.50,404.00,403.50,403.50,403.00,402.50,402.50,402.50,402.50,403.00,403.50,404.00,404.50,405.00,406.00,406.50,407.00,407.50,408.00,408.50,409.00,409.50,410.00,410.50,410.50,410.50,410.50,410.50,411.00,411.50,411.50,412.00,412.50,412.50,412.50,413.00,413.50,413.50,414.00,414.50,414.50,415.00,415.50,415.50,416.00,416.50,417.00,417.50,417.50,418.00,418.50,419.00,420.00,421.00,422.00,423.00,424.00,425.00,425.50,426.00,427.00,428.00,428.50,429.00,429.50,430.00,430.50,431.00,431.50,431.50,431.50,431.50,432.00,432.50,432.50,433.00,433.50,434.00,434.50,434.50,435.00,435.50,435.50,436.00,436.50,436.50,436.50,437.00,437.50,437.50,437.50,438.00,438.50,438.50,439.00,439.50,439.50,440.00,440.50,440.50,441.00,441.50,442.00,442.50,443.00,444.00,444.50,445.00,446.00,447.00,447.50,448.00,448.50,449.00,449.50,449.50,449.50,449.50,449.50,449.50,449.50,449.00,448.50,448.50,448.50,448.50,448.50,449.00,449.50,449.50,449.50,449.50,449.50,449.50,449.50,449.50,449.50,449.50,449.50,449.00,448.50,448.00,447.50,447.00,446.00,445.50,445.00,444.50,444.00,443.50,443.00,442.50,442.00,441.50,441.00,440.50,440.50,440.50,440.00,439.50,439.50,439.00,438.50,438.00,437.50,437.00,436.50,436.00,435.50,435.00,434.50,434.00,433.50,433.50,433.00,432.50,432.50,432.00,431.50,431.00,430.50,430.00,429.00,428.00,427.50,427.00,426.50,426.50,426.00,425.50,425.50,425.00,424.50,424.00,423.50,423.00,422.50,422.50,422.00,421.50,421.00,420.50,420.00,419.00,418.50,418.50,418.00,417.50,417.00,416.50,416.00,415.50,415.00,414.50,414.50,414.00,413.50,413.50,413.50,413.50,413.50,413.50,413.50,413.50,413.50,413.50,413.50,413.50,414.00,414.50,414.50,415.00,415.50,415.50,415.00,414.50,393.00,393.00,393.00]

x_sub = [100.50,101.00,102.00,102.50,103.00,103.50,104.00,104.50,105.00,105.50,106.00,107.00,107.50,108.00,109.00,109.50,110.00,111.00,111.50,112.00,112.50,113.00,114.00,114.50,115.00,115.50,116.00,117.00,117.50,117.50,118.00,118.50,119.00,120.00,120.50,121.00,122.00,122.50,123.00,124.00,124.50,125.00,126.00,126.50,126.50,126.50,126.00,125.50,125.00,124.50,124.50,124.50,125.00,126.00,127.00,127.50,128.00,128.50,129.00,130.00,131.00,132.00,133.00,133.50,134.00,135.00,135.50,136.00,137.00,137.50,138.00,139.00,139.50,140.00,141.00,141.50,142.00,143.00,143.50,144.00,145.00,146.00,146.50,147.00,148.00,148.50,149.00,150.00,150.50,151.00,151.50,151.50,152.00,152.50,152.50,152.50,152.00,151.00,150.50,150.00,149.00,148.50,148.00,147.00,146.50,146.00,145.50,145.00,144.00,143.00,142.50,142.00,141.00,140.50,140.00,139.00,138.50,138.00,137.00,136.50,136.00,135.00,134.50,134.00,133.50,133.00,132.50,132.00,131.50,131.00,130.50,130.00,129.50,130.00,130.50,131.00,131.50,132.00,133.00,133.50,134.00,134.50,135.00,136.00,136.50,137.00,138.00,138.50,139.00,140.00,141.00,141.50,142.00,143.00,143.50,144.00,144.50,145.00,146.00,146.50,147.00,147.50,148.00,148.50,149.00,150.00,150.50,151.00,151.50,152.00,152.50,153.00,154.00,154.50,155.00,156.00,156.50,157.00,158.00,158.50,159.00,160.00,160.50,161.00,162.00,162.50,163.00,163.50,164.00,164.50,165.00,165.50,165.50,166.00,166.50,166.00,165.50,165.00,164.50,164.00,163.50,163.00,162.00,161.50,161.00,160.00,159.50,159.00,158.50,158.00,157.00,156.50,156.00,155.50,155.00,154.00,153.50,153.00,152.50,152.00,151.00,150.50,150.00,149.00,148.50,148.00,147.50,147.00,146.00,145.50,145.00,144.50,144.00,143.00,142.50,142.00,141.50,141.00,140.00,139.50,139.00,138.50,138.00,137.00,136.50,136.00,135.00,134.50,134.00,133.50,133.00,132.00,131.50,131.00,130.50,130.00,129.00,128.50,128.00,127.50,127.00,126.50,126.00,125.50,125.00,124.00,123.50,123.00,122.50,122.00,121.00,120.50,120.00,119.00,118.50,118.00,117.50,117.00,116.00,115.50,115.00,114.00,113.50,113.00,112.50,112.00,111.00,110.50,110.00,109.50,109.00,108.50,108.00,107.00,106.50,106.00,105.00,104.50,104.00,103.50,103.00,102.00,101.00,100.50,100.00,99.00,98.50,98.00,97.50,97.00,96.50,96.50,96.00,95.50,95.50,96.00,96.50,97.00,97.50,98.00,99.00,100.00,100.50]

y_sub = [360.00,359.50,359.50,359.00,358.50,358.00,357.50,357.00,356.50,356.00,355.50,355.50,355.00,354.50,354.50,354.00,353.50,353.50,353.00,352.50,352.00,351.50,351.50,351.00,350.50,350.00,349.50,349.50,350.00,351.00,351.50,352.00,352.50,352.50,352.00,351.50,351.50,351.00,350.50,350.50,350.00,349.50,349.50,349.00,348.00,347.00,346.50,346.00,345.50,345.00,344.00,343.00,342.50,342.50,342.50,343.00,343.50,344.00,344.50,344.50,344.50,344.50,344.50,344.00,343.50,343.50,343.00,342.50,342.50,342.00,341.50,341.50,341.00,340.50,340.50,340.00,339.50,339.50,339.00,338.50,338.50,338.50,338.00,337.50,337.50,337.00,336.50,336.50,336.00,335.50,335.00,334.00,333.50,333.00,332.00,331.00,330.50,330.50,331.00,331.50,331.50,332.00,332.50,332.50,333.00,333.50,334.00,334.50,334.50,334.50,335.00,335.50,335.50,336.00,336.50,336.50,337.00,337.50,337.50,338.00,338.50,338.50,339.00,339.50,340.00,340.50,341.00,341.50,341.00,340.50,340.00,339.50,339.00,338.50,338.00,337.50,337.00,336.50,336.50,336.00,335.50,335.00,334.50,334.50,334.00,333.50,333.50,333.00,332.50,332.50,332.50,332.00,331.50,331.50,331.00,330.50,330.00,329.50,329.50,329.00,328.50,328.00,327.50,327.00,326.50,326.50,326.00,325.50,325.00,324.50,324.00,323.50,323.50,323.00,322.50,322.50,322.00,321.50,321.50,321.00,320.50,320.50,320.00,319.50,319.50,319.00,318.50,318.00,317.50,317.00,316.50,316.00,315.00,314.50,314.00,313.50,313.00,312.50,312.00,311.50,312.00,312.50,312.50,313.00,313.50,313.50,314.00,314.50,315.00,315.50,315.50,316.00,316.50,317.00,317.50,317.50,318.00,318.50,319.00,319.50,319.50,320.00,320.50,320.50,321.00,321.50,322.00,322.50,322.50,323.00,323.50,324.00,324.50,324.50,325.00,325.50,326.00,326.50,326.50,327.00,327.50,328.00,328.50,328.50,329.00,329.50,329.50,330.00,330.50,331.00,331.50,331.50,332.00,332.50,333.00,333.50,333.50,334.00,334.50,335.00,335.50,336.00,336.50,337.00,337.50,337.50,338.00,338.50,339.00,339.50,339.50,340.00,340.50,340.50,341.00,341.50,342.00,342.50,342.50,343.00,343.50,343.50,344.00,344.50,345.00,345.50,345.50,346.00,346.50,347.00,347.50,348.00,348.50,348.50,349.00,349.50,349.50,350.00,350.50,351.00,351.50,351.50,351.50,352.00,352.50,352.50,353.00,353.50,354.00,354.50,355.00,356.00,356.50,357.00,358.00,358.50,359.00,359.50,360.00,360.50,360.50,360.50,360.00]

def Identify_NonOutliers(df, percent=0.1):
    Q1 = df.quantile(percent)
    Q3 = df.quantile(1-percent)
    IQR = Q3 - Q1
    trueList = ~((df < (Q1 - 1.5 * IQR)) |(df > (Q3 + 1.5 * IQR)))
    return trueList

import numpy as np
import matplotlib.pyplot as plt
import matplotlib as mpl
mpl.rcParams['savefig.format'] = 'svg'
import pandas as pd
from shapely import Polygon, Point, LineString, MultiLineString, polygonize
from shapely.ops import split
from scipy.signal import savgol_filter

# Shape setup
x = savgol_filter(x, 30, 3)
y = savgol_filter(y, 30, 3)
x_sub = savgol_filter(x_sub, 30, 3)
y_sub = savgol_filter(y_sub, 30, 3)

shape = Polygon([(x,y) for x,y in zip(x,y)])
subshape = Polygon([(x,y) for x,y in zip(x_sub,y_sub)])

shape = shape-subshape

# # x,y is the exterior shell, x_i,y_i is the interior shell
x,y = shape.exterior.xy
x_sub, y_sub = shape.interiors[0].xy

# Calculating curvature at every point (exterior)
n=0
xp, yp, xpp, ypp = None, None, None, None
klist = []
for xc, yc in zip(x,y):
    # Skip the first two entries; xpp/ypp not defined here
    if n <= 3:
        n+=1
        continue
    xp = xc-x[n-2]
    yp = yc-y[n-2]
    xp_r = x[n-2]-x[n-4]
    yp_r = y[n-2]-y[n-4]
    xpp = xp-xp_r
    ypp = yp-yp_r
    k = abs(xp*ypp-yp*xpp)/((xp**2+yp**2)**(3/2))
    klist.append((k,xc,yc))
    n+=1

df = pd.DataFrame({
    'k': [k[0] for k in klist],
    'x': [k[1] for k in klist],
    'y': [k[2] for k in klist]
})

# Calculating curvature at every point (interior)
n=0
xp, yp, xpp, ypp = None, None, None, None
klist = []
for xc, yc in zip(x_sub,y_sub):
    # Skip the first two entries; xpp/ypp not defined here
    if n <= 3:
        n+=1
        continue
    xp = xc-x_sub[n-2]
    yp = yc-y_sub[n-2]
    xp_r = x_sub[n-2]-x_sub[n-4]
    yp_r = y_sub[n-2]-y_sub[n-4]
    xpp = xp-xp_r
    ypp = yp-yp_r
    k = abs(xp*ypp-yp*xpp)/((xp**2+yp**2)**(3/2))
    klist.append((k,xc,yc))
    n+=1

df_sub = pd.DataFrame({
    'k': [k[0] for k in klist],
    'x': [k[1] for k in klist],
    'y': [k[2] for k in klist]
})

# Create a copied full list of both
df_full = pd.concat([df, df_sub], ignore_index=True, sort=False)

# Find all points that don't lie too far away from the mean (ext)
nonOutlierList = Identify_NonOutliers(df, 0.15)
df = df[~nonOutlierList.k]
# Find all points that don't lie too far away from the mean (int)
nonOutlierList = Identify_NonOutliers(df_sub, 0.15)
df_sub = df_sub[~nonOutlierList.k]
# Concatenate the 
df = pd.concat([df, df_sub], ignore_index=True, sort=False)
df['matched'] = False

# Iterate over every curvature point and sort distance to nearest other curvature points
min_arc_dist = 10 # Minimum arclength distance
max_spatial_dist = 20 # Max spatial distance between two curvature points
min_area = 300 # Minimum subpolygon area for a connection to be considered valid

s_index = 0
shapelist = [shape]
multisegments = []
for xc,yc,kc in zip(df.x, df.y, df.k):
    s_index = 0
    for s in shapelist:
        if s.touches(Point([xc, yc])) or s.contains(Point([xc,yc])):
            break
        else:
            s_index += 1
        # elif s_index < len(shapelist)-1:
        #     s_index+=1
        # else:
        #     break

    shape = shapelist[s_index]

    if df[df.k == kc].iloc[0].matched:
        continue
    df['dist'] = df.apply(lambda row: np.linalg.norm(np.array([row.x, row.y]) - np.array([xc, yc])), axis=1)
    df.sort_values('dist', ignore_index=True, inplace=True)

    # Don't consider already-matched curvature values
    df['considered'] = df.apply(lambda row: not row.matched, axis=1)

    # Don't consider curvatures too far away
    df['considered'] = df.apply(lambda row: row.considered and row.dist <= max_spatial_dist, axis=1)

    # Make sure values are far away from one another on the line
    orig_index = df_full[df_full.k == kc].index
    df['considered'] = df.apply(lambda row: row.considered and abs(df_full[df_full.k == row.k].index-orig_index) > min_arc_dist, axis=1)

    # Make sure the interpolated line between each curvature point lies entirely within the shape. 
    df['considered'] = df.apply(lambda row: row.considered and np.array([shape.contains(Point(c1,c2)) or Point(c1,c2).touches(shape) for c1,c2 in zip(np.linspace(row.x, xc, 10), np.linspace(row.y, yc, 10))]).all(),  axis=1)

    # Divide Polygon based on string
    try:
        connx = df[df.considered == True].iloc[0].x
        conny = df[df.considered == True].iloc[0].y
        connk = df[df.considered == True].iloc[0].k
        conn_full_ind = df_full[df_full.k == connk].index
    except IndexError:
        continue
    line = LineString([(xc, yc), (connx, conny)])
    res = split(shape, line)

    # Check if the resultant polygons are below the minimum area
    ptf = np.array([r.area > min_area for r in res.geoms])
    if not ptf.all():
        continue

    # Update the shape_list
    shapelist.pop(s_index)
    shapelist.extend([s for s in res.geoms])

    # Add LineString to multisegments if only 1 geom returned (i.e. didn't divide in two)
    if len(res.geoms) == 1:
        multisegments.append((orig_index, conn_full_ind))

    # Create subshape if multisegments form a closed shape
    if len(multisegments) == 2:
        df1_0 = df_full.iloc[multisegments[0][0]]
        df1_1 = df_full.iloc[multisegments[0][1]]
        df2_0 = df_full.iloc[multisegments[1][0]]
        df2_1 = df_full.iloc[multisegments[1][1]]

        line1 = LineString([(df1_0.x, df1_0.y), (df1_1.x, df1_1.y)])
        line2 = LineString([(df2_0.x, df2_0.y), (df2_1.x, df2_1.y)])
        if multisegments[0][0] > multisegments[1][0]:
            line3_df = df_full.iloc[multisegments[1][0].values[0]:multisegments[0][0].values[0]+1]
        else:
            line3_df = df_full.iloc[multisegments[0][0].values[0]:multisegments[1][0].values[0]+1]
        if multisegments[0][1] > multisegments[1][1]:
            line4_df = df_full.iloc[multisegments[1][1].values[0]:multisegments[0][1].values[0]+1]
        else:
            line4_df = df_full.iloc[multisegments[0][1].values[0]:multisegments[1][1].values[0]+1]
        line3 = LineString([(x,y) for x,y in zip(line3_df.x, line3_df.y)])
        line4 = LineString([(x,y) for x,y in zip(line4_df.x, line4_df.y)])

        intersect = polygonize([line1, line3, line2, line4]).geoms[0]

        s1 = shape-intersect
                
        shapelist.pop(s_index)
        shapelist.extend([s1,intersect])
        multisegments = []

    # Draw a line to the nearest one
    plt.plot((xc, connx), (yc, conny), color='red')

    # Mark both curvature points and nearby points on both sides as being matched
    df['matched'] = df.apply(lambda row: row.matched or abs(df_full[df_full.k == row.k].index - orig_index) < min_arc_dist, axis=1)
    opp_index = df_full[df_full.k == df[df.considered == True].iloc[0].k].index
    df['matched'] = df.apply(lambda row: row.matched or abs(df_full[df_full.k == row.k].index - opp_index) < min_arc_dist, axis=1)


plt.scatter(df.x, df.y, s=1, c=(df.k), cmap="inferno")
plt.scatter(df_sub.x, df_sub.y, s=1, c=(df_sub.k), cmap="inferno")

i=0
for s in shapelist:
    colors = ["green","blue","orange", "red"]
    x,y = s.exterior.xy
    plt.plot(x,y, color=colors[i])
    if len(s.interiors):
        x,y = s.interiors[0].xy
        plt.plot(x,y, color=colors[i])
    i+=1

# plt.plot(x,y, x_sub, y_sub, alpha=0.3, color="plum")
plt.title("Cutting curvature")
plt.show()